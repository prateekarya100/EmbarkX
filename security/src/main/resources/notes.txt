-- Make sure you're in the correct database
CREATE DATABASE IF NOT EXISTS embarkx;
USE embarkx;

-- Drop if already exists (for clean setup)
DROP TABLE IF EXISTS authorities;
DROP TABLE IF EXISTS users;

-- Create users table
CREATE TABLE users (
  username VARCHAR(50) NOT NULL PRIMARY KEY,
  password VARCHAR(500) NOT NULL,
  enabled BOOLEAN NOT NULL
);

-- Create authorities table
CREATE TABLE authorities (
  username VARCHAR(50) NOT NULL,
  authority VARCHAR(50) NOT NULL,
  CONSTRAINT fk_authorities_users
    FOREIGN KEY (username) REFERENCES users(username)
    ON DELETE CASCADE
);

-- Create unique index (only after table exists)
CREATE UNIQUE INDEX ix_auth_username
  ON authorities (username, authority);
